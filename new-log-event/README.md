# New Log Event

PowerShell script for generating custom Windows Event Log entries with specified sizes. Useful for testing log ingestion, validating Splunk Windows event collection, and creating controlled test data.

## Purpose

Create Windows event log entries of specific sizes to:

- Test Splunk Universal Forwarder event collection
- Validate event size limits and handling
- Generate test data for Windows event dashboards
- Troubleshoot event ingestion pipelines

## Requirements

- Windows operating system
- PowerShell 3.0 or higher
- **Administrator privileges required** (script checks and exits if not running as admin)

## Usage

```powershell
.\New-LogEvent.ps1 -Size <characters> -Path <log_name>
```

### Parameters

- `-Size` - Required. Number of characters in event message (1-32000)
- `-Path` - Required. Windows event log name (e.g., Application, System)
- `-Source` - Optional. Event source name (default: CustomEventSource)

### Examples

```powershell
# Create 8KB event in Application log
.\New-LogEvent.ps1 -Size 8000 -Path Application

# Create 1KB event in System log
.\New-LogEvent.ps1 -Size 1024 -Path System

# Create event with custom source
.\New-LogEvent.ps1 -Size 5000 -Path Application -Source MySplunkTest
```

## Output

Script creates an Information-level event (Event ID 1001) with:

- Base message: "This is a test event generated by Write-CustomEventLog."
- Padding: 'X' characters to reach specified size
- Confirmation message showing actual size written

### Example Output

```
Event written to Application with size 8000 characters
```

## Notes

- **Always requires Administrator privileges** - script validates elevation before running
- Creating new event sources requires admin rights (one-time per source name)
- Events appear in Windows Event Viewer under specified log
- Script uses Event ID 1001 for all generated events
- Useful for testing Splunk's Windows event input configuration
- Maximum event size: 32000 characters (Windows limitation)
- Uses `throw` for proper PowerShell error handling (catchable by calling code)
